# ÐžÑ‡Ð¸Ñ‰ÐµÐ½Ð½Ñ Ð¿Ñ–ÑÐ»Ñ Ð¼Ñ–Ð³Ñ€Ð°Ñ†Ñ–Ñ— Ð½Ð° Ð¼Ñ–ÐºÑ€Ð¾ÑÐµÑ€Ð²Ñ–ÑÐ¸

## ðŸŽ¯ ÐœÐµÑ‚Ð°
ÐŸÑ–ÑÐ»Ñ ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾Ñ— Ð¼Ñ–Ð³Ñ€Ð°Ñ†Ñ–Ñ— Ð½Ð° Ð¼Ñ–ÐºÑ€Ð¾ÑÐµÑ€Ð²Ñ–ÑÐ½Ñƒ Ð°Ñ€Ñ…Ñ–Ñ‚ÐµÐºÑ‚ÑƒÑ€Ñƒ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ Ð²Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ ÑÑ‚Ð°Ñ€Ñ– Ñ„Ð°Ð¹Ð»Ð¸ Ð¼Ð¾Ð½Ð¾Ð»Ñ–Ñ‚Ð½Ð¾Ð³Ð¾ Ð´Ð¾Ð´Ð°Ñ‚ÐºÑƒ, Ñ‰Ð¾Ð± ÑƒÐ½Ð¸ÐºÐ½ÑƒÑ‚Ð¸ Ð¿Ð»ÑƒÑ‚Ð°Ð½Ð¸Ð½Ð¸.

## âš ï¸ Ð’ÐÐ–Ð›Ð˜Ð’Ðž
**ÐÐ• Ð’Ð˜Ð”ÐÐ›Ð¯Ð™Ð¢Ð• Ð¦Ð† Ð¤ÐÐ™Ð›Ð˜, ÐŸÐžÐšÐ˜ ÐÐ• Ð’ÐŸÐ•Ð’ÐÐ•ÐÐ†, Ð©Ðž ÐœÐ†ÐšÐ ÐžÐ¡Ð•Ð Ð’Ð†Ð¡Ð˜ ÐŸÐ ÐÐ¦Ð®Ð®Ð¢Ð¬ ÐšÐžÐ Ð•ÐšÐ¢ÐÐž!**

Ð¡Ð¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ Ð¿ÐµÑ€ÐµÐºÐ¾Ð½Ð°Ð¹Ñ‚ÐµÑÑ:
1. Ð’ÑÑ– Ð¼Ñ–ÐºÑ€Ð¾ÑÐµÑ€Ð²Ñ–ÑÐ¸ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÑŽÑ‚ÑŒÑÑ Ð±ÐµÐ· Ð¿Ð¾Ð¼Ð¸Ð»Ð¾Ðº
2. Frontend Ð¿Ñ–Ð´ÐºÐ»ÑŽÑ‡Ð°Ñ”Ñ‚ÑŒÑÑ Ð´Ð¾ API Gateway
3. API Gateway Ð¼Ð¾Ð¶Ðµ Ð·'Ñ”Ð´Ð½Ð°Ñ‚Ð¸ÑÑ Ð· Auth Ñ‚Ð° Spell ÑÐµÑ€Ð²Ñ–ÑÐ°Ð¼Ð¸
4. Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð¸Ñ… Ð¿Ñ€Ð°Ñ†ÑŽÑ” ÐºÐ¾Ñ€ÐµÐºÑ‚Ð½Ð¾
5. Ð’ÑÑ– Ð¾ÑÐ½Ð¾Ð²Ð½Ñ– Ñ„ÑƒÐ½ÐºÑ†Ñ–Ñ— Ð¿Ñ€Ð°Ñ†ÑŽÑŽÑ‚ÑŒ

## ðŸ“¦ Ð¤Ð°Ð¹Ð»Ð¸ Ð´Ð»Ñ Ð²Ð¸Ð´Ð°Ð»ÐµÐ½Ð½Ñ (Ð¿Ñ–ÑÐ»Ñ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ¸)

### Ð¡Ñ‚Ð°Ñ€Ñ– Ð¼Ð¾Ð½Ð¾Ð»Ñ–Ñ‚Ð½Ñ– Ñ„Ð°Ð¹Ð»Ð¸

```bash
# 1. Ð¡Ñ‚Ð°Ñ€Ð¸Ð¹ backend ÑÐµÑ€Ð²ÐµÑ€
server/
  â”œâ”€â”€ server.js
  â”œâ”€â”€ Dockerfile
  â””â”€â”€ package.json

# 2. Ð¡Ñ‚Ð°Ñ€Ñ– React Ñ„Ð°Ð¹Ð»Ð¸ Ð² root (ÑÐºÑ‰Ð¾ Ð²Ð¾Ð½Ð¸ Ð´ÑƒÐ±Ð»ÑŽÑŽÑ‚ÑŒÑÑ Ð² web/)
src/           # Ð¢Ñ–Ð»ÑŒÐºÐ¸ ÑÐºÑ‰Ð¾ Ñ” ÐºÐ¾Ð¿Ñ–Ñ Ð² web/src/
public/        # Ð¢Ñ–Ð»ÑŒÐºÐ¸ ÑÐºÑ‰Ð¾ Ñ” ÐºÐ¾Ð¿Ñ–Ñ Ð² web/public/

# 3. Ð¡Ñ‚Ð°Ñ€Ð¸Ð¹ package.json (Ð·Ð°Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð½Ð° Ð½Ð¾Ð²Ð¸Ð¹ monorepo Ð²ÐµÑ€ÑÑ–ÑŽ)
package.json   # Ð—Ð°Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð½Ð° package.json.new
```

### ÐšÐ¾Ð¼Ð°Ð½Ð´Ð¸ Ð´Ð»Ñ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð½Ñ

```bash
# ÐšÐ ÐžÐš 1: Backup Ð¿ÐµÑ€ÐµÐ´ Ð²Ð¸Ð´Ð°Ð»ÐµÐ½Ð½ÑÐ¼
git checkout -b backup-before-cleanup
git add .
git commit -m "backup: before cleanup of old monolith files"
git push origin backup-before-cleanup

# ÐšÐ ÐžÐš 2: Ð’Ð¸Ð´Ð°Ð»ÐµÐ½Ð½Ñ ÑÑ‚Ð°Ñ€Ð¸Ñ… Ñ„Ð°Ð¹Ð»Ñ–Ð² (Ð½Ð° main branch)
git checkout main

# Ð’Ð¸Ð´Ð°Ð»ÑÑ”Ð¼Ð¾ ÑÑ‚Ð°Ñ€Ð¸Ð¹ server
rm -rf server/

# Ð’Ð¸Ð´Ð°Ð»ÑÑ”Ð¼Ð¾ ÑÑ‚Ð°Ñ€Ñ– src/public ÑÐºÑ‰Ð¾ Ð²Ð¾Ð½Ð¸ Ð´ÑƒÐ±Ð»ÑŽÑŽÑ‚ÑŒÑÑ
# Ð£Ð’ÐÐ“Ð: ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ñ‚Ðµ ÑÐ¿Ð¾Ñ‡Ð°Ñ‚ÐºÑƒ Ñ‡Ð¸ Ð²ÑÐµ Ñ” Ð² web/
# ls web/src/ web/public/
# Ð¯ÐºÑ‰Ð¾ Ð²ÑÐµ Ð½Ð° Ð¼Ñ–ÑÑ†Ñ–:
rm -rf src/ public/

# Ð—Ð°Ð¼Ñ–Ð½ÑŽÑ”Ð¼Ð¾ package.json
mv package.json package.json.old
mv package.json.new package.json

# Ð’Ð¸Ð´Ð°Ð»ÑÑ”Ð¼Ð¾ ÑÑ‚Ð°Ñ€Ñ– Ð·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚Ñ–
rm -rf node_modules/
npm install

# ÐšÐ ÐžÐš 3: ÐžÐ½Ð¾Ð²Ð»ÑŽÑ”Ð¼Ð¾ .gitignore
cat >> .gitignore << EOF

# Backup files
*.old
*.backup
EOF

# ÐšÐ ÐžÐš 4: Commit
git add .
git commit -m "chore(cleanup): remove old monolith files after microservices migration

- Removed old server/ directory
- Removed duplicate src/ and public/ (moved to web/)
- Updated package.json to monorepo version with workspaces
- Added npm scripts for monorepo management

Refs: #migration-to-microservices"

git push origin main
```

## ðŸ” ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ð¿ÐµÑ€ÐµÐ´ Ð²Ð¸Ð´Ð°Ð»ÐµÐ½Ð½ÑÐ¼

### Checklist

- [ ] ÐœÑ–ÐºÑ€Ð¾ÑÐµÑ€Ð²Ñ–ÑÐ¸ Ð¿Ñ€Ð°Ñ†ÑŽÑŽÑ‚ÑŒ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾ (docker-compose up)
- [ ] ÐœÐ¾Ð¶Ð½Ð° Ð·Ð°Ñ€ÐµÑ”ÑÑ‚Ñ€ÑƒÐ²Ð°Ñ‚Ð¸ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð°
- [ ] ÐœÐ¾Ð¶Ð½Ð° Ð·Ð°Ð»Ð¾Ð³Ñ–Ð½Ð¸Ñ‚Ð¸ÑÑ
- [ ] ÐœÐ¾Ð¶Ð½Ð° ÑÑ‚Ð²Ð¾Ñ€Ð¸Ñ‚Ð¸ spell
- [ ] ÐœÐ¾Ð¶Ð½Ð° Ð¾Ñ‚Ñ€Ð¸Ð¼Ð°Ñ‚Ð¸ ÑÐ¿Ð¸ÑÐ¾Ðº spells
- [ ] Frontend Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð²Ñ–Ð´Ð¾Ð±Ñ€Ð°Ð¶Ð°Ñ”Ñ‚ÑŒÑÑ
- [ ] ÐÐµÐ¼Ð°Ñ” Ð¿Ð¾Ð¼Ð¸Ð»Ð¾Ðº Ð² Ð»Ð¾Ð³Ð°Ñ… ÑÐµÑ€Ð²Ñ–ÑÑ–Ð²
- [ ] Production Ð´ÐµÐ¿Ð»Ð¾Ð¹ Ð¿Ñ€Ð°Ñ†ÑŽÑ” ÐºÐ¾Ñ€ÐµÐºÑ‚Ð½Ð¾
- [ ] Ð¡Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¾ backup branch

### ÐšÐ¾Ð¼Ð°Ð½Ð´Ð¸ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ¸

```bash
# ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ñ‰Ð¾ Ð²ÑÑ– ÑÐµÑ€Ð²Ñ–ÑÐ¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ñ–
docker-compose ps

# ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€ÐºÐ° Ð»Ð¾Ð³Ñ–Ð²
docker-compose logs auth-service
docker-compose logs spell-service
docker-compose logs gateway
docker-compose logs web

# Ð¢ÐµÑÑ‚Ð¾Ð²Ñ– Ð·Ð°Ð¿Ð¸Ñ‚Ð¸
# Ð ÐµÑ”ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"test@test.com","password":"test123"}'

# Ð›Ð¾Ð³Ñ–Ð½
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@test.com","password":"test123"}'

# ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ñ‚Ð¸ spells
curl http://localhost:3000/api/spells
```

## ðŸ“Š ÐŸÐ¾Ñ€Ñ–Ð²Ð½ÑÐ½Ð½Ñ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸

### Ð”Ð¾ (ÐœÐ¾Ð½Ð¾Ð»Ñ–Ñ‚Ð½Ð°)
```
SpellBook/
â”œâ”€â”€ server/          â† Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸
â”‚   â””â”€â”€ server.js    â† Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸
â”œâ”€â”€ src/             â† Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ (ÑÐºÑ‰Ð¾ Ð´ÑƒÐ±Ð»ÑŽÑ”Ñ‚ÑŒÑÑ Ð² web/)
â”œâ”€â”€ public/          â† Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ (ÑÐºÑ‰Ð¾ Ð´ÑƒÐ±Ð»ÑŽÑ”Ñ‚ÑŒÑÑ Ð² web/)
â”œâ”€â”€ package.json     â† Ð—Ð°Ð¼Ñ–Ð½Ð¸Ñ‚Ð¸ Ð½Ð° monorepo Ð²ÐµÑ€ÑÑ–ÑŽ
â””â”€â”€ node_modules/    â† Ð’Ð¸Ð´Ð°Ð»Ð¸Ñ‚Ð¸ Ñ‚Ð° reinstall
```

### ÐŸÑ–ÑÐ»Ñ (ÐœÑ–ÐºÑ€Ð¾ÑÐµÑ€Ð²Ñ–ÑÐ¸)
```
SpellBook/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ auth-service/
â”‚   â””â”€â”€ spell-api/
â”œâ”€â”€ gateway/
â”œâ”€â”€ web/              â† Ð’ÐµÑÑŒ frontend Ñ‚ÑƒÑ‚
â”‚   â”œâ”€â”€ src/
â”‚   â””â”€â”€ public/
â”œâ”€â”€ scripts/          â† ÐÐ¾Ð²Ñ– utility scripts
â”œâ”€â”€ package.json      â† Monorepo Ð²ÐµÑ€ÑÑ–Ñ
â””â”€â”€ infrastructure/
```

## ðŸ”„ Rollback Ð¿Ð»Ð°Ð½

Ð¯ÐºÑ‰Ð¾ Ñ‰Ð¾ÑÑŒ Ð¿Ñ–ÑˆÐ»Ð¾ Ð½Ðµ Ñ‚Ð°Ðº:

```bash
# ÐŸÐ¾Ð²ÐµÑ€Ð½ÑƒÑ‚Ð¸ÑÑ Ð´Ð¾ backup
git checkout backup-before-cleanup

# ÐÐ±Ð¾ Ð²Ñ–Ð´Ð½Ð¾Ð²Ð¸Ñ‚Ð¸ Ð¾ÐºÑ€ÐµÐ¼Ñ– Ñ„Ð°Ð¹Ð»Ð¸ Ð· backup
git checkout backup-before-cleanup -- server/
git checkout backup-before-cleanup -- src/
git checkout backup-before-cleanup -- package.json
```

## ðŸ“ ÐŸÑ–ÑÐ»Ñ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð½Ñ

1. ÐžÐ½Ð¾Ð²Ñ–Ñ‚ÑŒ README.md Ð· Ð½Ð¾Ð²Ð¾ÑŽ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¾ÑŽ
2. ÐžÐ½Ð¾Ð²Ñ–Ñ‚ÑŒ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ñ–ÑŽ Ð² docs/
3. Ð’Ð¸Ð´Ð°Ð»Ñ–Ñ‚ÑŒ Ñ†ÐµÐ¹ Ñ„Ð°Ð¹Ð» (MIGRATION_CLEANUP.md) - Ð²Ñ–Ð½ Ð±Ñ–Ð»ÑŒÑˆÐµ Ð½Ðµ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±ÐµÐ½
4. Ð’Ð¸Ð´Ð°Ð»Ñ–Ñ‚ÑŒ backup branch Ñ‡ÐµÑ€ÐµÐ· Ð¼Ñ–ÑÑÑ†ÑŒ ÑÐºÑ‰Ð¾ Ð²ÑÐµ Ð¿Ñ€Ð°Ñ†ÑŽÑ”:
   ```bash
   git branch -d backup-before-cleanup
   git push origin --delete backup-before-cleanup
   ```

## ðŸ’¡ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ñ–Ñ—

- **Ð Ð¾Ð±Ñ–Ñ‚ÑŒ cleanup Ñ‚Ñ–Ð»ÑŒÐºÐ¸ Ð¿Ñ–ÑÐ»Ñ Ñ‚Ð¾Ð³Ð¾, ÑÐº production Ð¿Ñ€Ð°Ñ†ÑŽÑ” ÑÑ‚Ð°Ð±Ñ–Ð»ÑŒÐ½Ð¾ Ð¼Ñ–Ð½Ñ–Ð¼ÑƒÐ¼ Ñ‚Ð¸Ð¶Ð´ÐµÐ½ÑŒ**
- **Ð¢Ñ€Ð¸Ð¼Ð°Ð¹Ñ‚Ðµ backup branch Ð¼Ñ–Ð½Ñ–Ð¼ÑƒÐ¼ Ð¼Ñ–ÑÑÑ†ÑŒ**
- **ÐÐµ Ð²Ð¸Ð´Ð°Ð»ÑÐ¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð»Ð¸ Ð¿Ñ–Ð´ Ñ‡Ð°Ñ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾Ñ— Ñ€Ð¾Ð·Ñ€Ð¾Ð±ÐºÐ¸**
- **Ð—Ñ€Ð¾Ð±Ñ–Ñ‚ÑŒ Ð¿Ð¾Ð²Ð½Ð¸Ð¹ Ð±ÐµÐºÐ°Ð¿ Ð¿ÐµÑ€ÐµÐ´ cleanup**

---

**Ð¡Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¾**: 2024-01-15
**ÐÐ²Ñ‚Ð¾Ñ€**: Claude & Maksym
